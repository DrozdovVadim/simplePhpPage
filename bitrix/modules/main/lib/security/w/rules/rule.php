<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____14525090']= array(base64_decode('a'.'XNfc3Rya'.'W5n'),base64_decode('c3Ry'.'d'.'G9sb3d'.'lcg=='),base64_decode('a'.'XNfYXJ'.'yYXk'.'='),base64_decode(''.'aX'.'Nfc3RyaW5n'),base64_decode('Z'.'3pk'.'Z'.'W'.'N'.'vZ'.'GU='),base64_decode('YmFzZT'.'Y0X2'.'RlY29k'.'ZQ='.'='),base64_decode('dXJsZGVjb2Rl'),base64_decode('YX'.'JyYXlfcm'.'V2Z'.'X'.'JzZQ=='),base64_decode('Z3'.'pl'.'bmNv'.'Z'.'GU='),base64_decode(''.'YmFzZTY0'.'X2VuY29kZ'.'Q=='),base64_decode(''.'dXJ'.'sZW5j'.'b2'.'Rl'),base64_decode('Ymlu'.'Mmh'.'le'.'A=='),base64_decode('aXNfYXJ'.'yYXk='),base64_decode('c'.'3'.'Ry'.'dG9sb3dlc'.'g=='),base64_decode(''.'aX'.'Nf'.'Y'.'X'.'JyYXk='),base64_decode('a'.'m'.'9'.'p'.'bg'.'=='),base64_decode('Zm5'.'tYXRja'.'A=='),base64_decode('cmF3dXJsZG'.'Vj'.'b2Rl'),base64_decode('c3V'.'ic3Ry'),base64_decode('c'.'3'.'Vic3Ry'),base64_decode('c3RyX'.'3JlcGxh'.'Y'.'2U='),base64_decode('c'.'HJlZ19xdW90Z'.'Q'.'=='),base64_decode('cHJ'.'lZ19tYXR'.'jaA'.'='.'='));if(!function_exists(__NAMESPACE__.'\\___1190575665')){function ___1190575665($_2068595510){static $_1831234986= false; if($_1831234986 == false) $_1831234986=array('Y'.'WN0aW9'.'u','aW50dmFs',''.'cGF0aA='.'=','Y'.'29udGV4dA==','a2V5cw==','cHJvY2V'.'zcw'.'==','Z'.'W5jb2'.'Rpbmc'.'=','cHJlZ19yZXBsY'.'WNl','cGF0aA='.'=','Y29udGV4dA==','a2V5cw==','c'.'H'.'J'.'vY'.'2Vzcw==','ZW'.'5jb2Rp'.'bm'.'c=','cGF0'.'dGVy'.'bg==',''.'cHJ'.'lZ'.'1'.'9tY'.'XRj'.'a'.'A==','cG'.'F0a'.'A'.'='.'=',''.'Y29udGV4d'.'A'.'==','a2V5cw==','cHJvY2Vzcw='.'=','ZW5jb2Rp'.'bmc=','c'.'GF'.'0dGVybg==','cG9'.'z'.'dF9hY3Rpb'.'24=','Y2hlY2tfY3N'.'yZ'.'g'.'='.'=','cGF0aA==','Y29udGV'.'4'.'d'.'A==','a2V5c'.'w='.'=','c'.'HJvY2Vz'.'c'.'w='.'=','ZW5jb2Rpb'.'mc=','c'.'G'.'F'.'0dGVybg==','YWN'.'0'.'aW9u',''.'YWN0aW9u','YW'.'N0aW9u','YW'.'N'.'0aW9u',''.'Y'.'WN0'.'aW9u','Y'.'W'.'N0'.'aW'.'9u','cG'.'9zdF9hY3Rpb2'.'4=','ZW5'.'jb2Rp'.'bmc=','ZW5jb2'.'Rpbm'.'c=','Z'.'W5jb'.'2Rpb'.'mc=','ZW5'.'jb2Rpbmc=','ZW5'.'jb2'.'R'.'pbm'.'c=','ZW5'.'jb2Rpbmc=','Z3o=','YmFzZTY'.'0','dXJ'.'s','aGV4','Lg==','L'.'w'.'==','aW'.'5kZXgucGh'.'w','L'.'2luZGV4LnBocA==','U0'.'NSSVB'.'UX05BTUU=','L'.'2'.'luZ'.'G'.'V4LnBocA==','U'.'0NSS'.'VBUX'.'05BTUU=',''.'U0NSSVBUX'.'05BTUU=',''.'U0'.'NSSVBUX05BT'.'UU'.'=','fg==','f'.'l4'.'=','fg'.'==','XH'.'4'.'=','JH'.'4=');return base64_decode($_1831234986[$_2068595510]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1900531271; protected $_892183522; protected $_2118979140; protected $_557581012; protected $_681304737; public static function make(array $_365164620):?static{ $_365164620= static::prepareRuleParameters($_365164620); return match($_365164620[___1190575665(0)]){ ___1190575665(1) => new IntvalRule( $_365164620[___1190575665(2)], $_365164620[___1190575665(3)], $_365164620[___1190575665(4)], $_365164620[___1190575665(5)], $_365164620[___1190575665(6)]), ___1190575665(7) => new PregReplaceRule( $_365164620[___1190575665(8)], $_365164620[___1190575665(9)], $_365164620[___1190575665(10)], $_365164620[___1190575665(11)], $_365164620[___1190575665(12)], $_365164620[___1190575665(13)]), ___1190575665(14) => new PregMatchRule( $_365164620[___1190575665(15)], $_365164620[___1190575665(16)], $_365164620[___1190575665(17)], $_365164620[___1190575665(18)], $_365164620[___1190575665(19)], $_365164620[___1190575665(20)], $_365164620[___1190575665(21)]), ___1190575665(22) => new CsrfRule( $_365164620[___1190575665(23)], $_365164620[___1190575665(24)], $_365164620[___1190575665(25)], $_365164620[___1190575665(26)], $_365164620[___1190575665(27)], $_365164620[___1190575665(28)],), default => null,};} protected static function prepareRuleParameters(array $_624472321): array{ if($GLOBALS['____14525090'][0]($_624472321[___1190575665(29)])){ $_624472321[___1190575665(30)]= $GLOBALS['____14525090'][1]($_624472321[___1190575665(31)]);} elseif($GLOBALS['____14525090'][2]($_624472321[___1190575665(32)])){ $_217689602= $_624472321[___1190575665(33)]; $_624472321[___1190575665(34)]= $_217689602[(976-2*488)]; $_624472321[___1190575665(35)]= $_217689602[round(0+0.5+0.5)];} $_624472321[___1190575665(36)]=!empty($_624472321[___1190575665(37)])? $_624472321[___1190575665(38)]:[]; if($GLOBALS['____14525090'][3]($_624472321[___1190575665(39)])){ $_624472321[___1190575665(40)]=[$_624472321[___1190575665(41)]];} return $_624472321;}  public function __construct($_1900531271, $_892183522, $_2118979140, $_557581012, $_681304737){ $this->_1900531271= $_1900531271; $this->_892183522= $this->castContext($_892183522); $this->_2118979140= $this->castKeys($_2118979140); $this->_557581012= $_557581012; $this->_681304737= $_681304737;} public function evaluateValue($_1089595610){ if(!empty($this->_681304737)){ foreach($this->_681304737 as $_1173473058){ $_1089595610= match($_1173473058){ 'gz' => $GLOBALS['____14525090'][4]($_1089595610), 'base64' => $GLOBALS['____14525090'][5]($_1089595610), 'url' => $GLOBALS['____14525090'][6]($_1089595610), 'hex' => hex2bin($_1089595610)};}} $_1896843456= $this->evaluate($_1089595610); if(!empty($this->_681304737) && $_1896843456 instanceof ModifyResult){ $_337099198= $_1896843456->getCleanValue(); foreach($GLOBALS['____14525090'][7]($this->_681304737) as $_1173473058){ $_337099198= match($_1173473058){ ___1190575665(42) => $GLOBALS['____14525090'][8]($_337099198), ___1190575665(43) => $GLOBALS['____14525090'][9]($_337099198), ___1190575665(44) => $GLOBALS['____14525090'][10]($_337099198), ___1190575665(45) => $GLOBALS['____14525090'][11]($_337099198)};} $_1896843456= new ModifyResult($_337099198);} return $_1896843456;} abstract public function evaluate($_1089595610); protected function castContext($_892183522){ if(!$GLOBALS['____14525090'][12]($_892183522)){ $_892183522=[$_892183522];} foreach($_892183522 as $_1512166958 => $_849195453){ $_892183522[$_1512166958]= $GLOBALS['____14525090'][13]($_849195453);} return $_892183522;} protected function castKeys($_2118979140){ if(!$GLOBALS['____14525090'][14]($_2118979140)){ $_2118979140=[$_2118979140];} return $_2118979140;} public function matchKey(array $_2096297308): bool{ $_2096297308= $GLOBALS['____14525090'][15](___1190575665(46), $_2096297308); foreach($this->_2118979140 as $_960721168){   if($GLOBALS['____14525090'][16]($_960721168, $_2096297308)){ return true;}} return false;}  public function matchPath($_1139257677){ if($this->_1900531271 === '*'){ return true;}  $_769964798= new Uri($_1139257677); $_1887924491= $_769964798->getPath(); $_1887924491= $GLOBALS['____14525090'][17]($_1887924491);      if(str_ends_with($_1887924491, ___1190575665(47))){ $_1887924491 .= ___1190575665(48);} $_1887924491= Path::normalize($_1887924491);  $_974808562[]= $_1887924491; if(str_ends_with($_1887924491, ___1190575665(49))){ $_974808562[]= $GLOBALS['____14525090'][18]($_1887924491,(844-2*422),-round(0+9));} elseif(str_ends_with($_SERVER[___1190575665(50)], ___1190575665(51))){ $_974808562[]= $GLOBALS['____14525090'][19]($_SERVER[___1190575665(52)],(1420/2-710),-round(0+2.25+2.25+2.25+2.25));} if($_1887924491 !== $_SERVER[___1190575665(53)]){ $_974808562[]= $_SERVER[___1190575665(54)];}  if(str_starts_with($this->_1900531271, ___1190575665(55))){ $_529137581= $this->_1900531271;} else{ $_529137581= ___1190575665(56). $GLOBALS['____14525090'][20](___1190575665(57), ___1190575665(58), $GLOBALS['____14525090'][21]($this->_1900531271)). ___1190575665(59);} foreach($_974808562 as $_920245512){ if($this->_1900531271 === $_920245512 || $GLOBALS['____14525090'][22]($_529137581, $_920245512)){ return true;}} return false;}  public function getPath(){ return $this->_1900531271;}  public function getContext(){ return $this->_892183522;}  public function getKeys(){ return $this->_2118979140;}  public function getProcess(){ return $this->_557581012;}}?>